/** * SWFAddress 2.2: Deep linking for Flash and Ajax <http://www.asual.com/swfaddress/> * * SWFAddress is (c) 2006-2008 Rostislav Hristov and contributors * This software is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> * */if(typeof asual=="undefined"){asual={};}if(typeof asual.swfaddress=="undefined"){asual.swfaddress={};}if(typeof asual.util=="undefined"){asual.util={};}asual.util.Browser=new function(){var H=-1,C=navigator.userAgent,E=false,F=false,B=false,G=false,D=false;var A=function(J,I){return parseFloat(C.substr(C.indexOf(J)+I));};if(E=/MSIE/.test(C)){H=A("MSIE",4);}if(B=/AppleWebKit/.test(C)){H=A("Safari",7);}if(G=/Opera/.test(C)){H=parseFloat(navigator.appVersion);}if(F=/Camino/.test(C)){H=A("Camino",7);}if(D=(/Firefox/.test(C)&&!F)){H=A("Firefox",8);}this.toString=function(){return "[class Browser]";};this.getVersion=function(){return H;};this.isIE=function(){return E;};this.isSafari=function(){return B;};this.isOpera=function(){return G;};this.isCamino=function(){return F;};this.isFirefox=function(){return D;};this.isNetscape=function(){return _netscape;};this.isMozilla=function(){return _mozilla;};};asual.util.Events=new function(){var C="DOMContentLoaded",G="onstop",I=window,F=document,B=[],A=asual.util,D=A.Browser;this.toString=function(){return "[class Events]";};this.addListener=function(L,J,K){B.push({o:L,t:J,l:K});if(!(J==C&&(D.isIE()||D.isSafari()))){if(L.addEventListener){L.addEventListener(J,K,false);}else{if(L.attachEvent){L.attachEvent("on"+J,K);}}}};this.removeListener=function(N,K,L){for(var J=0,M;M=B[J];J++){if(M.o==N&&M.t==K&&M.l==L){B.splice(J,1);break;}}if(!(K==C&&(D.isIE()||D.isSafari()))){if(N.removeEventListener){N.removeEventListener(K,L,false);}else{if(N.detachEvent){N.detachEvent("on"+K,L);}}}};var H=function(){for(var K=0,J;J=B[K];K++){if(J.t!=C){A.Events.removeListener(J.o,J.t,J.l);}}};var E=function(){if(F.readyState=="interactive"){function J(){F.detachEvent(G,J);H();};F.attachEvent(G,J);I.setTimeout(function(){F.detachEvent(G,J);},0);}};if(D.isIE()||D.isSafari()){(function(){try{if((D.isIE()&&F.body)||!/loaded|complete/.test(F.readyState)){F.documentElement.doScroll("left");}}catch(K){return setTimeout(arguments.callee,0);}for(var J=0,K;K=B[J];J++){if(K.t==C){K.l.call(null);}}})();}if(D.isIE()){I.attachEvent("onbeforeunload",E);}this.addListener(I,"unload",H);};asual.util.Functions=new function(){this.toString=function(){return "[class Functions]";};this.extend=function(C,A){function B(){};B.prototype=C.prototype;A.prototype=new B();A.prototype.constructor=A;A.superConstructor=C;A.superClass=C.prototype;return A;};this.bind=function(F,B,E){for(var C=2,D,A=[];D=arguments[C];C++){A.push(D);}return function(){return F.apply(B,A);};};};asual.swfaddress.WEBAddressEvent=function(D){var A=asual.swfaddress.WEBAddress;this.toString=function(){return "[object WEBAddressEvent]";};this.type=D;this.target=[A][0];this.value=A.getValue();this.path=A.getPath();this.pathNames=A.getPathNames();this.parameters={};var E=A.getParameterNames();for(var C=0,B=E.length;C<B;C++){this.parameters[E[C]]=A.getParameter(E[C]);}this.parametersNames=E;};asual.swfaddress.WEBAddressEvent.INIT="init";asual.swfaddress.WEBAddressEvent.CHANGE="change";asual.swfaddress.WEBAddress=new function(){var ID="",_2e="function",_2f="undefined",_30=asual.swfaddress,_31=asual.util,_32=_31.Browser,_33=_31.Events,_34=_31.Functions,_35=_32.getVersion(),_36=false,_t=top,_d=_t.document,_h=_t.history,_l=_t.location,_si=setInterval,_st=setTimeout,_dc=decodeURIComponent,_ec=encodeURIComponent,_3f,_40,_41,_42=_d.title,_43=_h.length,_44=false,_45=false,_46=true,_47=true,_48=[],_49={},_4a={history:true,html:false,strict:true,tracker:"_trackDefault"};if(_32.isIE()){_36=_35>=6;}if(_32.isSafari()){_36=_35>=312;}if(_32.isOpera()){_36=_35>=9.02;}if(_32.isCamino()){_36=_35>=1;}if(_32.isFirefox()){_36=_35>=1;}if((!_36&&_l.href.indexOf("#")!=-1)||(_32.isSafari()&&_35<412&&_l.href.indexOf("#")!=-1&&_l.search!="")){_d.open();_d.write("<html><head><meta http-equiv=\"refresh\" content=\"0;url="+_l.href.substr(0,_l.href.indexOf("#"))+"\" /></head></html>");_d.close();}var _4b=function(){var _4c=_l.href.indexOf("#");return _4c!=-1?_l.href.substr(_4c+1):"";};var _4d=_4b();var _4e=function(_4f,_50){if(_4a.strict){_4f=_50?(_4f.substr(0,1)!="/"?"/"+_4f:_4f):(_4f==""?"/":_4f);}return _4f;};var _51=function(_52){return (_32.isIE()&&_l.protocol=="file:")?_4d.replace(/\?/,"%3F"):_52;};var _53=function(el){for(var i=0,l=el.childNodes.length,s;i<l;i++){if(el.childNodes[i].src){_41=String(el.childNodes[i].src);}if(s=_53(el.childNodes[i])){return s;}}};var _58=function(){if(_32.isIE()&&_d.title!=_42&&_d.title.indexOf("#")!=-1){_d.title=_42;if(_4a.html&&_3f&&_3f.contentWindow&&_3f.contentWindow.document){_3f.contentWindow.document.title=_42;}}};var _59=function(){if(!_44){var _5a=_4b();if(_32.isIE()){if(_4d!=_5a){if(_35<7){_l.reload();}else{this.setValue(_5a);}}}else{if(_32.isSafari()&&_35<523){if(_43!=_h.length){_43=_h.length;if(typeof _48[_43-1]!=_2f){_4d=_48[_43-1];}_5b.call(this);}}else{if(_4d!=_5a){_4d=_5a;_5b.call(this);}}}_58.call(this);}};var _5c=function(_5d){this.dispatchEvent(new _30.WEBAddressEvent(_5d));_5d=_5d.substr(0,1).toUpperCase()+_5d.substr(1);if(typeof this["on"+_5d]==_2e){this["on"+_5d]();}};var _5e=function(){_5c.call(this,"init");};var _5f=function(){_5c.call(this,"change");};var _5b=function(){_5f.call(this);_st(_34.bind(_60,this),10);};var _61=function(_62){if(typeof urchinTracker==_2e){urchinTracker(_62);}if(typeof pageTracker!=_2f&&typeof pageTracker._trackPageview==_2e){pageTracker._trackPageview(_62);}};eval("var _trackDefault = "+_61+";");var _60=function(){if(typeof _4a.tracker!=_2f&&eval("typeof "+_4a.tracker+" != \""+_2f+"\"")){var fn=eval(_4a.tracker);if(typeof fn==_2e){fn((_l.pathname+(/\/$/.test(_l.pathname)?"":"/")+this.getValue()).replace(/\/\//,"/").replace(/^\/$/,""));}}};var _64=function(){var doc=_3f.contentWindow.document;doc.open();doc.write("<html><head><title>"+_d.title+"</title><script>var "+ID+" = \""+_ec(_4b())+"\";</script></head></html>");doc.close();};var _66=function(){var win=_3f.contentWindow;var src=win.location.href;_4d=(_4a.html)?(src.indexOf("?")>-1?_dc(src.substr(src.indexOf("?")+1)):""):(typeof win[ID]!=_2f?_dc(win[ID]):"");if(_4a.html){win.document.title=_42;}if(_4d!=_4b()){_5b.call(_30.WEBAddress);_l.hash=_51(_4d);}};var _69=function(){if(!_45){_45=true;var _6a="id=\""+ID+"\" style=\"position:absolute;top:-9999px;\"";if(_32.isIE()&&_35<8){_d.body.appendChild(_d.createElement("div")).innerHTML="<iframe "+_6a+" src=\""+(_4a.html?_41.replace(/\.js(\?.*)?$/,".html")+"?"+_ec(_4b()):"javascript:false;")+"\" width=\"0\" height=\"0\"></iframe>";_3f=_d.getElementById(ID);_st(function(){_33.addListener(_3f,"load",_66);if(!_4a.html&&typeof _3f.contentWindow[ID]==_2f){_64();}},50);}else{if(_32.isSafari()){if(_35<412){_d.body.innerHTML+="<form "+_6a+" method=\"get\"></form>";_40=_d.getElementById(ID);}if(typeof _l[ID]==_2f){_l[ID]={};}if(typeof _l[ID][_l.pathname]!=_2f){_48=_l[ID][_l.pathname].split(",");}}}_st(_34.bind(_5e,this),1);_st(_34.bind(_5f,this),2);_st(_34.bind(_60,this),10);if(_32.isIE()&&_35>=8){_d.body.onhashchange=_34.bind(_59,this);_si(_34.bind(_58,this),50);}else{_si(_34.bind(_59,this),50);}}};this.onInit=null;this.onChange=null;this.toString=function(){return "[class WEBAddress]";};this.back=function(){_h.back();};this.forward=function(){_h.forward();};this.up=function(){var _6b=this.getPath();this.setValue(_6b.substr(0,_6b.lastIndexOf("/",_6b.length-2)+(_6b.substr(_6b.length-1)=="/"?1:0)));};this.go=function(_6c){_h.go(_6c);};this.addEventListener=function(_6d,_6e){if(typeof _49[_6d]==_2f){_49[_6d]=[];}_49[_6d].push(_6e);};this.removeEventListener=function(_6f,_70){if(typeof _49[_6f]!=_2f){for(var i=0,l;l=_49[_6f][i];i++){if(l==_70){break;}}_49[_6f].splice(i,1);}};this.dispatchEvent=function(_73){if(this.hasEventListener(_73.type)){_73.target=this;for(var i=0,l;l=_49[_73.type][i];i++){l(_73);}return true;}return false;};this.hasEventListener=function(_76){return (typeof _49[_76]!=_2f&&_49[_76].length>0);};this.getBaseURL=function(){var url=_l.href;if(url.indexOf("#")!=-1){url=url.substr(0,url.indexOf("#"));}if(url.substr(url.length-1)=="/"){url=url.substr(0,url.length-1);}return url;};this.getStrict=function(){return _4a.strict;};this.setStrict=function(_78){_4a.strict=_78;};this.getHistory=function(){return _4a.history;};this.setHistory=function(_79){_4a.history=_79;};this.getTracker=function(){return _4a.tracker;};this.setTracker=function(_7a){_4a.tracker=_7a;};this.getTitle=function(){return _d.title;};this.setTitle=function(_7b){if(!_36){return null;}if(typeof _7b==_2f){return;}if(_7b=="null"){_7b="";}_42=_d.title=_7b;_st(function(){if((_47||_4a.html)&&_3f&&_3f.contentWindow&&_3f.contentWindow.document){_3f.contentWindow.document.title=_7b;_47=false;}if(!_46&&(_32.isCamino()||_32.isFirefox())){_l.replace(_l.href.indexOf("#")!=-1?_l.href:_l.href+"#");}_46=false;},50);};this.getStatus=function(){return _t.status;};this.setStatus=function(_7c){if(typeof _7c==_2f){return;}if(!_32.isSafari()){_7c=_4e((_7c!="null")?_7c:"",true);if(_7c=="/"){_7c="";}if(!(/http(s)?:\/\//.test(_7c))){var _7d=_l.href.indexOf("#");_7c=(_7d==-1?_l.href:_l.href.substr(0,_7d))+"#"+_7c;}_t.status=_7c;}};this.resetStatus=function(){_t.status="";};this.getValue=function(){if(!_36){return null;}return _4e(_4d,false);};this.setValue=function(_7e){if(!_36){return null;}if(typeof _7e==_2f){return;}if(_7e=="null"){_7e="";}_7e=_4e(_7e,true);if(_7e=="/"){_7e="";}if(_4d==_7e){return;}_46=true;_4d=_7e;_44=true;_5b.call(_30.WEBAddress);_48[_h.length]=_4d;if(_32.isSafari()){if(_4a.history){_l[ID][_l.pathname]=_48.toString();_43=_h.length+1;if(_35<412){if(_l.search==""){_40.action="#"+_4d;_40.submit();}}else{if(_35<523||_4d==""){var evt=_d.createEvent("MouseEvents");evt.initEvent("click",true,true);var _80=_d.createElement("a");_80.href="#"+_4d;_80.dispatchEvent(evt);}else{_l.hash="#"+_4d;}}}else{_l.replace("#"+_4d);}}else{if(_4d!=_4b()){if(_4a.history){_l.hash="#"+_51(_4d);}else{_l.replace("#"+_4d);}}}if((_32.isIE()&&_35<8)&&_4a.history){if(_4a.html){var loc=_3f.contentWindow.location;loc.assign(loc.pathname+"?"+_4b());}else{_st(_64,50);}}if(_32.isSafari()){_st(function(){_44=false;},1);}else{_44=false;}};this.getPath=function(){var _82=this.getValue();return (_82.indexOf("?")!=-1)?_82.split("?")[0]:_82;};this.getPathNames=function(){var _83=this.getPath();var _84=_83.split("/");if(_83.substr(0,1)=="/"||_83.length==0){_84.splice(0,1);}if(_83.substr(_83.length-1,1)=="/"){_84.splice(_84.length-1,1);}return _84;};this.getQueryString=function(){var _85=this.getValue();var _86=_85.indexOf("?");return (_86!=-1&&_86<_85.length)?_85.substr(_86+1):"";};this.getParameter=function(_87){var _88=this.getValue();var _89=_88.indexOf("?");if(_89!=-1){_88=_88.substr(_89+1);var _8a=_88.split("&");var p,i=_8a.length;while(i--){p=_8a[i].split("=");if(p[0]==_87){return p[1];}}}return "";};this.getParameterNames=function(){var _8d=this.getValue();var _8e=_8d.indexOf("?");var _8f=[];if(_8e!=-1){_8d=_8d.substr(_8e+1);if(_8d!=""&&_8d.indexOf("=")!=-1){var _90=_8d.split("&");var i=0;while(i<_90.length){_8f.push(_90[i].split("=")[0]);i++;}}}return _8f;};if(_36){for(var i=1;i<_43;i++){_48.push("");}_48.push(_4b());if(_32.isIE()&&_l.hash!=_4b()){_l.hash="#"+_51(_4b());}_53(document);var _qi=_41.indexOf("?");if(_41&&_qi>-1){var _94,_95=_41.substr(_qi+1).split("&");for(var i=0,p;p=_95[i];i++){_94=p.split("=");if(/^(history|html|strict)$/.test(_94[0])){_4a[_94[0]]=(isNaN(_94[1])?eval(_94[1]):(parseFloat(_94[1])>0));}if(/^tracker$/.test(_94[0])){_4a[_94[0]]=_94[1];}}}if(/file:\/\//.test(_l.href)){_4a.html=false;}var _ei=_41.indexOf(".js"),l;if(_41&&_ei>-1){while(_ei--){l=_41.substr(_ei,1);if(/(\/|\\)/.test(l)){break;}ID=l+ID;}}_58.call(this);if(window==_t){_33.addListener(document,"DOMContentLoaded",_34.bind(_69,this));}_33.addListener(_t,"load",_34.bind(_69,this));}else{_60();}};SWFAddressEvent=asual.swfaddress.SWFAddressEvent=function(A){SWFAddressEvent.superConstructor.apply(this,arguments);this.target=[SWFAddress][0];this.toString=function(){return "[object SWFAddressEvent]";};};asual.util.Functions.extend(asual.swfaddress.WEBAddressEvent,SWFAddressEvent);asual.swfaddress.SWFAddressEvent.INIT="init";asual.swfaddress.SWFAddressEvent.CHANGE="change";SWFAddress=asual.swfaddress.SWFAddress=new function(){var _9a="undefined",_t=top,_l=_t.location,_9d=this,_9e=[],_9f={},_a0=asual.util.Functions,_a1=asual.swfaddress.WEBAddress;for(var p in _a1){this[p]=_a1[p];}var _a3=function(_a4){this.dispatchEvent(new SWFAddressEvent(_a4));_a4=_a4.substr(0,1).toUpperCase()+_a4.substr(1);if(typeof this["on"+_a4]=="function"){this["on"+_a4]();}};var _a5=function(){_a3.call(this,"init");};var _a6=function(){_a7();_a3.call(this,"change");};var _a7=function(){for(var i=0,id,obj,_ab=SWFAddress.getValue(),_ac="setSWFAddressValue";id=_9e[i];i++){obj=document.getElementById(id);if(obj){if(obj.parentNode&&typeof obj.parentNode.so!=_9a){obj.parentNode.so.call(_ac,_ab);}else{if(!(obj&&typeof obj[_ac]!=_9a)){var _ad=obj.getElementsByTagName("object");var _ae=obj.getElementsByTagName("embed");obj=((_ad[0]&&typeof _ad[0][_ac]!=_9a)?_ad[0]:((_ae[0]&&typeof _ae[0][_ac]!=_9a)?_ae[0]:null));}if(obj){obj[_ac](_ab);}}}else{if(obj=document[id]){if(typeof obj[_ac]!=_9a){obj[_ac](_ab);}}}}};this.toString=function(){return "[class SWFAddress]";};this.addEventListener=function(_af,_b0){if(typeof _9f[_af]==_9a){_9f[_af]=[];}_9f[_af].push(_b0);};this.removeEventListener=function(_b1,_b2){if(typeof _9f[_b1]!=_9a){for(var i=0,l;l=_9f[_b1][i];i++){if(l==_b2){break;}}_9f[_b1].splice(i,1);}};this.dispatchEvent=function(_b5){if(typeof _9f[_b5.type]!=_9a&&_9f[_b5.type].length){_b5.target=this;for(var i=0,l;l=_9f[_b5.type][i];i++){l(_b5);}return true;}return false;};this.hasEventListener=function(_b8){return (typeof _9f[_b8]!=_9a&&_9f[_b8].length>0);};this.href=function(url,_ba){_ba=typeof _ba!=_9a?_ba:"_self";if(_ba=="_self"){self.location.href=url;}else{if(_ba=="_top"){_l.href=url;}else{if(_ba=="_blank"){window.open(url);}else{_t.frames[_ba].location.href=url;}}}};this.popup=function(url,_bc,_bd,_be){var _bf=window.open(url,_bc,eval(_bd));eval(_be);};this.getIds=function(){return _9e;};this.getId=function(_c0){return _9e[0];};this.setId=function(id){_9e[0]=id;};this.addId=function(id){this.removeId(id);_9e.push(id);};this.removeId=function(id){for(var i=0;i<_9e.length;i++){if(id==_9e[i]){_9e.splice(i,1);break;}}};_a1.addEventListener("init",_a0.bind(_a5,this));_a1.addEventListener("change",_a0.bind(_a6,this));(function(){var _c5;if(typeof FlashObject!=_9a){SWFObject=FlashObject;}if(typeof SWFObject!=_9a&&SWFObject.prototype&&SWFObject.prototype.write){var _s1=SWFObject.prototype.write;SWFObject.prototype.write=function(){_c5=arguments;if(this.getAttribute("version").major<8){this.addVariable("$swfaddress",SWFAddress.getValue());((typeof _c5[0]=="string")?document.getElementById(_c5[0]):_c5[0]).so=this;}var _c7;if(_c7=_s1.apply(this,_c5)){_9d.addId(this.getAttribute("id"));}return _c7;};}if(typeof swfobject!=_9a){var _c8=swfobject.registerObject;swfobject.registerObject=function(){_c5=arguments;_c8.apply(this,_c5);_9d.addId(_c5[0]);};var _c9=swfobject.createSWF;swfobject.createSWF=function(){_c5=arguments;_c9.apply(this,_c5);_9d.addId(_c5[0].id);};var _ca=swfobject.embedSWF;swfobject.embedSWF=function(){_c5=arguments;_ca.apply(this,_c5);_9d.addId(_c5[8].id);};}if(typeof UFO!=_9a){var _u=UFO.create;UFO.create=function(){_c5=arguments;_u.apply(this,_c5);_9d.addId(_c5[0].id);};}if(typeof AC_FL_RunContent!=_9a){var _a=AC_FL_RunContent;AC_FL_RunContent=function(){_c5=arguments;_a.apply(this,_c5);for(var i=0,l=_c5.length;i<l;i++){if(_c5[i]=="id"){_9d.addId(_c5[i+1]);}}};}})();};